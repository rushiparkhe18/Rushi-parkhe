import{CardElement as Pe}from"@stripe/react-stripe-js";import w from"react";function _(e){let{prefix:t,field:r,errors:o,...s}=e;if(o==null)return null;let n=r?o.getFieldErrors(r):o.getFormErrors();return n.length===0?null:w.createElement("div",{...s},t?`${t} `:null,n.map(a=>a.message).join(", "))}import{createClient as S,getDefaultClient as H}from"@formspree/core";import{Elements as B}from"@stripe/react-stripe-js";import{loadStripe as K}from"@stripe/stripe-js/pure.js";import d,{useContext as N,useEffect as h,useMemo as O,useState as W}from"react";import R from"react";import{useElements as M}from"@stripe/react-stripe-js";import{createContext as k,useContext as A}from"react";var v=k({elements:null});function P(e){let{children:t}=e,r=M();return R.createElement(v.Provider,{value:{elements:r}},t)}function C(){return A(v)}var D=d.createContext(null);function U(e){let{children:t,project:r,stripePK:o}=e,[s,n]=W(S({project:r})),a=O(()=>o?K(o):null,[o]);return h(()=>{let i=!0;return i&&n(l=>l.project!==r?S({...l,project:r}):l),()=>{i=!1}},[r]),h(()=>{let i=!0;return a?.then(l=>{i&&l&&n(m=>S({...m,stripe:l}))}),()=>{i=!1}},[a]),d.createElement(D.Provider,{value:{client:s}},a?d.createElement(B,{stripe:a},d.createElement(P,null,t)):t)}function g(){return N(D)??{client:H()}}import{useState as f}from"react";import{appendExtraData as I,isSubmissionError as $}from"@formspree/core";var T="2.5.5";import{CardElement as G}from"@stripe/react-stripe-js";var L=`@formspree/react@${T}`;function b(e,t={}){let r=g(),{elements:o}=C(),{client:s=r.client,extraData:n,onError:a,onSuccess:i,origin:l}=t,{stripe:m}=s;return async function(p){let u=Y(p)?q(p):p;if(typeof n=="object")for(let[j,x]of Object.entries(n)){let c;typeof x=="function"?c=await x():c=x,c!==void 0&&I(u,j,c)}let E=o?.getElement(G),V=m&&E?()=>m.createPaymentMethod({type:"card",card:E,billing_details:J(u)}):void 0,y=await s.submitForm(e,u,{endpoint:l,clientName:L,createPaymentMethod:V});$(y)?a?.(y):i?.(y)}}function Y(e){return"preventDefault"in e&&typeof e.preventDefault=="function"}function q(e){e.preventDefault();let t=e.currentTarget;if(t.tagName!="FORM")throw new Error("submit was triggered for a non-form element");return new FormData(t)}function J(e){let t={address:Q(e)};for(let r of["name","email","phone"]){let o=e instanceof FormData?e.get(r):e[r];o&&typeof o=="string"&&(t[r]=o)}return t}function Q(e){let t={};for(let[r,o]of[["address_line1","line1"],["address_line2","line2"],["address_city","city"],["address_country","country"],["address_state","state"],["address_postal_code","postal_code"]]){let s=e instanceof FormData?e.get(r):e[r];s&&typeof s=="string"&&(t[o]=s)}return t}function X(e,t={}){let[r,o]=f(null),[s,n]=f(null),[a,i]=f(!1),[l,m]=f(!1);if(!e)throw new Error('You must provide a form key or hashid (e.g. useForm("myForm") or useForm("123xyz")');let F=b(e,{client:t.client,extraData:t.data,onError(p){o(p),i(!1),m(!1)},onSuccess(p){o(null),n(p),i(!1),m(!0)},origin:t.endpoint});return[{errors:r,result:s,submitting:a,succeeded:l},async function(u){i(!0),await F(u)},function(){o(null),n(null),i(!1),m(!1)}]}export{Pe as CardElement,U as FormspreeProvider,_ as ValidationError,X as useForm,g as useFormspree,b as useSubmit};
